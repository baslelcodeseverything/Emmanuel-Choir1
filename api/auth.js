async function postJSON(url,data){const r=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});return r.json();}
const f=document.getElementById('f'); if(f){ f.onsubmit=async e=>{ e.preventDefault(); if(location.pathname.endsWith('register.html')){ const res=await postJSON('/api/register',{name:name.value,email:email.value,password:password.value}); msg.textContent=res.success?'Registered! Please login.':('Error: '+(res.error||'')); } else { const res=await postJSON('/api/login',{email:email.value,password:password.value}); if(res.success){ location='/chat.html'; } else msg.textContent='Error: '+(res.error||''); } } }
